<!DOCTYPE html><html><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com https://text.pollinations.ai https://image.pollinations.ai https://api.allorigins.win https://cors-anywhere.herokuapp.com https://thingproxy.freeboard.io;
        connect-src 'self' https://text.pollinations.ai https://image.pollinations.ai https://api.allorigins.win https://cors-anywhere.herokuapp.com https://thingproxy.freeboard.io;
        img-src 'self' data: blob: https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com https://image.pollinations.ai https://api.allorigins.win;
        frame-src 'self' https://www.youtube.com https://trytako.com;
        child-src 'self';
        manifest-src 'self';
        worker-src 'self';
        upgrade-insecure-requests;
        block-all-mixed-content;">
    <meta http-equiv="x-dns-prefetch-control" content="off">
    <meta name="x-poe-datastore-behavior" content="disabled">
    <meta name="x-poe-allow-downloads" content="true">
    <script src="https://puc.poecdn.net/standard.25f6d5ebb7608dc2f276.js"></script>
    <meta charset="utf-8">
    <title>Minecraft Meme Generator</title>
    <link rel="icon" type="image/x-icon" href="icon.png">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <script src="https://puc.poecdn.net/disableWebRTC.9710cebe07429a9e8e06.js"></script>
    <script src="https://puc.poecdn.net/tw.b9024aecac666455e183.js"></script>
    <script src="https://puc.poecdn.net/deps.faccd16000d314dc16d5.js"></script>
    <script src="https://puc.poecdn.net/exports.b0f0f482cdeb5302b0b9.js"></script>
    <script src="https://puc.poecdn.net/renderer.75c73ae6b4235f62945a.js"></script>
    <script>
        Object.defineProperty(exports, "__esModule", {value: true}); 
        function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
        var _react = require('react'); 
        var _react2 = _interopRequireDefault(_react);
        var _lucidereact = require('lucide-react');

        function MinecraftMemeGenerator() {
            const [userPrompt, setUserPrompt] = _react.useState.call(void 0, '');
            const [optimizedPrompt, setOptimizedPrompt] = _react.useState.call(void 0, '');
            const [generatedImage, setGeneratedImage] = _react.useState.call(void 0, '');
            const [directImageUrl, setDirectImageUrl] = _react.useState.call(void 0, '');
            const [isOptimizing, setIsOptimizing] = _react.useState.call(void 0, false);
            const [isGenerating, setIsGenerating] = _react.useState.call(void 0, false);
            const [error, setError] = _react.useState.call(void 0, '');
            const [corsMethod, setCorsMethod] = _react.useState.call(void 0, 'direct');

            const optimizePrompt = async () => {
                if (!userPrompt.trim()) {
                    setError('Please enter a prompt first');
                    return;
                }

                setIsOptimizing(true);
                setError('');
                
                try {
                    const enhancedPrompt = `Create a funny Minecraft meme prompt based on this idea: "${userPrompt}". Make it specific to Minecraft gameplay, blocks, mobs, or situations. Include visual details that would work well for a meme format. Keep it concise but descriptive.`;
                    
                    const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(enhancedPrompt)}`);
                    
                    if (!response.ok) {
                        throw new Error('Failed to optimize prompt');
                    }
                    
                    const textResponse = await response.text();
                    setOptimizedPrompt(textResponse.trim());
                } catch (err) {
                    setError('Failed to optimize prompt. Please try again.');
                    console.error('Optimization error:', err);
                } finally {
                    setIsOptimizing(false);
                }
            };

            // Multiple CORS proxy options
            const corsProxies = [
                (url) => `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`,
                (url) => `https://thingproxy.freeboard.io/fetch/${url}`,
                (url) => url // Direct access as fallback
            ];

            const tryFetchWithProxy = async (originalUrl, proxyIndex = 0) => {
                if (proxyIndex >= corsProxies.length) {
                    throw new Error('All proxy methods failed');
                }

                const proxyUrl = corsProxies[proxyIndex](originalUrl);
                console.log(`Trying proxy method ${proxyIndex + 1}:`, proxyUrl);

                try {
                    const response = await fetch(proxyUrl, {
                        method: 'GET',
                        headers: {
                            'Accept': 'image/*,*/*'
                        }
                    });

                    if (response.ok) {
                        const blob = await response.blob();
                        if (blob.size > 0 && blob.type.startsWith('image/')) {
                            console.log(`Proxy method ${proxyIndex + 1} successful`);
                            setCorsMethod(`proxy-${proxyIndex + 1}`);
                            return URL.createObjectURL(blob);
                        }
                    }
                    throw new Error(`Proxy ${proxyIndex + 1} failed`);
                } catch (error) {
                    console.log(`Proxy method ${proxyIndex + 1} failed:`, error);
                    return tryFetchWithProxy(originalUrl, proxyIndex + 1);
                }
            };

            const generateMeme = async () => {
                const promptToUse = optimizedPrompt || userPrompt;
                
                if (!promptToUse.trim()) {
                    setError('Please enter a prompt or optimize one first');
                    return;
                }

                setIsGenerating(true);
                setError('');
                setGeneratedImage('');
                setDirectImageUrl('');

                try {
                    const memePrompt = `Minecraft meme: ${promptToUse}. Funny, relatable, meme format, high quality, digital art`;
                    const timestamp = Date.now();
                    const seed = Math.floor(Math.random() * 1000000);
                    const originalUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(memePrompt)}?timestamp=${timestamp}&seed=${seed}&width=512&height=512`;
                    
                    // Store the direct URL for fallback
                    setDirectImageUrl(originalUrl);
                    
                    console.log('Attempting to fetch image with CORS workarounds...');
                    
                    try {
                        // Try to fetch with proxy methods
                        const blobUrl = await tryFetchWithProxy(originalUrl);
                        setGeneratedImage(blobUrl);
                        setError('');
                        console.log('Image successfully loaded via proxy');
                    } catch (proxyError) {
                        console.log('All proxy methods failed, using direct URL method');
                        setCorsMethod('direct');
                        
                        // Show the image container with direct URL and let browser handle it
                        setGeneratedImage(originalUrl);
                        setError('Image loaded via direct URL. If you see a CORS error, use the "Open Direct Link" button below to view the image.');
                    }
                    
                } catch (err) {
                    setError('Failed to generate meme. Please try again.');
                    console.error('Generation error:', err);
                } finally {
                    setIsGenerating(false);
                }
            };

            const downloadImage = async () => {
                if (!generatedImage && !directImageUrl) return;

                try {
                    const urlToDownload = generatedImage || directImageUrl;
                    
                    // If it's a blob URL, download directly
                    if (urlToDownload.startsWith('blob:')) {
                        const link = document.createElement('a');
                        link.href = urlToDownload;
                        link.download = `minecraft-meme-${Date.now()}.png`;
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        return;
                    }

                    // For direct URLs, try to fetch via proxy and download
                    try {
                        const blobUrl = await tryFetchWithProxy(urlToDownload);
                        
                        const link = document.createElement('a');
                        link.href = blobUrl;
                        link.download = `minecraft-meme-${Date.now()}.png`;
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        // Clean up blob URL
                        setTimeout(() => URL.revokeObjectURL(blobUrl), 1000);
                    } catch (fetchError) {
                        // Open in new tab as fallback
                        window.open(urlToDownload, '_blank');
                        setError('Download method failed. Image opened in new tab - right-click to save.');
                    }
                } catch (err) {
                    setError('Download failed. Try the "Open Direct Link" button to save manually.');
                    console.error('Download error:', err);
                }
            };

            const openDirectLink = () => {
                if (directImageUrl) {
                    window.open(directImageUrl, '_blank');
                }
            };

            const retryImageLoad = async () => {
                if (directImageUrl) {
                    setIsGenerating(true);
                    setError('Retrying with different proxy...');
                    
                    try {
                        const blobUrl = await tryFetchWithProxy(directImageUrl);
                        setGeneratedImage(blobUrl);
                        setError('');
                    } catch (error) {
                        setError('Retry failed. Please use "Open Direct Link" to view the image.');
                        setGeneratedImage(directImageUrl);
                    } finally {
                        setIsGenerating(false);
                    }
                }
            };

            const handleImageError = (e) => {
                console.log('Image failed to load in browser');
                setError('Image display failed due to CORS restrictions. The image was generated successfully - use "Open Direct Link" to view it, or try "Retry Load".');
            };

            const handleImageLoad = () => {
                setError('');
                console.log('Image loaded successfully in browser');
            };

            return (
                _react2.default.createElement('div', { className: "min-h-screen bg-gradient-to-br from-green-800 via-green-600 to-emerald-500 p-4" },
                    _react2.default.createElement('div', { className: "max-w-4xl mx-auto" },
                        /* Header */
                        _react2.default.createElement('div', { className: "text-center mb-8" },
                            _react2.default.createElement('h1', { className: "text-4xl md:text-6xl font-bold text-white mb-4 drop-shadow-lg" }, "ðŸ§± Minecraft Meme Generator"),
                            _react2.default.createElement('p', { className: "text-lg text-green-100 max-w-2xl mx-auto" }, "Create hilarious Minecraft memes with AI! Enter your idea and let our AI optimize it for the perfect Minecraft meme.")
                        ),

                        _react2.default.createElement('div', { className: "bg-white rounded-2xl shadow-2xl p-6 md:p-8 mb-8" },
                            /* Input Section */
                            _react2.default.createElement('div', { className: "mb-6" },
                                _react2.default.createElement('label', { className: "block text-lg font-semibold text-gray-700 mb-3" }, "Your Meme Idea:"),
                                _react2.default.createElement('textarea', {
                                    value: userPrompt,
                                    onChange: (e) => setUserPrompt(e.target.value),
                                    placeholder: "Enter your meme idea... (e.g., 'when you find diamonds but hear a creeper')",
                                    className: "w-full h-24 p-4 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:outline-none resize-none text-gray-700"
                                })
                            ),

                            /* Optimize Button */
                            _react2.default.createElement('div', { className: "mb-6" },
                                _react2.default.createElement('button', {
                                    onClick: optimizePrompt,
                                    disabled: isOptimizing || !userPrompt.trim(),
                                    className: "w-full md:w-auto bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2"
                                },
                                    isOptimizing ? (
                                        _react2.default.createElement(_lucidereact.Loader2, { className: "w-5 h-5 animate-spin" })
                                    ) : (
                                        _react2.default.createElement(_lucidereact.Wand2, { className: "w-5 h-5" })
                                    ),
                                    isOptimizing ? 'Optimizing...' : 'Optimize Prompt with AI'
                                )
                            ),

                            /* Optimized Prompt Display */
                            optimizedPrompt && (
                                _react2.default.createElement('div', { className: "mb-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg" },
                                    _react2.default.createElement('h3', { className: "font-semibold text-blue-800 mb-2" }, "Optimized Prompt:"),
                                    _react2.default.createElement('p', { className: "text-blue-700" }, optimizedPrompt)
                                )
                            ),

                            /* Generate Button */
                            _react2.default.createElement('div', { className: "mb-6" },
                                _react2.default.createElement('button', {
                                    onClick: generateMeme,
                                    disabled: isGenerating || (!userPrompt.trim() && !optimizedPrompt.trim()),
                                    className: "w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2"
                                },
                                    isGenerating ? (
                                        _react2.default.createElement(_lucidereact.Loader2, { className: "w-5 h-5 animate-spin" })
                                    ) : (
                                        _react2.default.createElement(_lucidereact.Image, { className: "w-5 h-5" })
                                    ),
                                    isGenerating ? 'Generating Meme...' : 'Generate Minecraft Meme'
                                )
                            ),

                            /* Error Display */
                            error && (
                                _react2.default.createElement('div', { className: "mb-6 p-4 bg-red-50 border-l-4 border-red-500 rounded-r-lg" },
                                    _react2.default.createElement('p', { className: "text-red-700" }, error)
                                )
                            ),

                            /* Loading indicator */
                            isGenerating && (
                                _react2.default.createElement('div', { className: "text-center mb-6" },
                                    _react2.default.createElement('div', { className: "inline-flex items-center gap-2 text-gray-600" },
                                        _react2.default.createElement(_lucidereact.Loader2, { className: "w-5 h-5 animate-spin" }),
                                        _react2.default.createElement('span', null, "Generating your meme...")
                                    )
                                )
                            ),

                            /* Generated Image */
                            (generatedImage || directImageUrl) && !isGenerating && (
                                _react2.default.createElement('div', { className: "text-center" },
                                    _react2.default.createElement('h3', { className: "text-xl font-semibold text-gray-700 mb-4" }, "Your Minecraft Meme:"),
                                    _react2.default.createElement('div', { className: "bg-gray-100 rounded-lg p-4 mb-4" },
                                        generatedImage ? (
                                            _react2.default.createElement('img', {
                                                src: generatedImage,
                                                alt: "Generated Minecraft Meme",
                                                className: "max-w-full h-auto mx-auto rounded-lg shadow-lg",
                                                onError: handleImageError,
                                                onLoad: handleImageLoad,
                                                crossOrigin: "anonymous"
                                            })
                                        ) : (
                                            _react2.default.createElement('div', { className: "bg-gray-200 rounded-lg p-8 text-center" },
                                                _react2.default.createElement(_lucidereact.ImageOff, { className: "w-16 h-16 mx-auto mb-4 text-gray-400" }),
                                                _react2.default.createElement('p', { className: "text-gray-600 mb-4" }, "Image generated but couldn't display due to CORS restrictions"),
                                                _react2.default.createElement('p', { className: "text-sm text-gray-500" }, "Use the buttons below to view your meme")
                                            )
                                        )
                                    ),
                                    _react2.default.createElement('div', { className: "flex flex-col sm:flex-row gap-3 justify-center flex-wrap" },
                                        _react2.default.createElement('button', {
                                            onClick: downloadImage,
                                            className: "bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2"
                                        },
                                            _react2.default.createElement(_lucidereact.Download, { className: "w-5 h-5" }), "Download"
                                        ),
                                        _react2.default.createElement('button', {
                                            onClick: openDirectLink,
                                            className: "bg-orange-600 hover:bg-orange-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2"
                                        },
                                            _react2.default.createElement(_lucidereact.ExternalLink, { className: "w-5 h-5" }), "Open Direct Link"
                                        ),
                                        !generatedImage && directImageUrl && (
                                            _react2.default.createElement('button', {
                                                onClick: retryImageLoad,
                                                className: "bg-yellow-600 hover:bg-yellow-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2"
                                            },
                                                _react2.default.createElement(_lucidereact.RefreshCw, { className: "w-5 h-5" }), "Retry Load"
                                            )
                                        )
                                    ),
                                    corsMethod && corsMethod !== 'direct' && (
                                        _react2.default.createElement('p', { className: "text-xs text-green-600 mt-2" }, `âœ“ Loaded using ${corsMethod}`)
                                    )
                                )
                            )
                        ),

                        /* Instructions */
                        _react2.default.createElement('div', { className: "bg-white bg-opacity-90 rounded-xl p-6 text-center" },
                            _react2.default.createElement('h3', { className: "text-lg font-semibold text-gray-700 mb-2" }, "How to use:"),
                            _react2.default.createElement('p', { className: "text-gray-600 mb-3" }, "1. Enter your meme idea â†’ 2. Click \"Optimize Prompt\" for AI enhancement (optional) â†’ 3. Generate your meme â†’ 4. Download and share!"),
                            _react2.default.createElement('div', { className: "text-sm text-gray-500 space-y-1" },
                                _react2.default.createElement('p', null, "ðŸ”§ CORS Fix: Multiple proxy methods implemented for better compatibility"),
                                _react2.default.createElement('p', null, "ðŸ“± If image doesn't show: Use \"Open Direct Link\" â†’ Right-click â†’ Save image"),
                                _react2.default.createElement('p', null, "ðŸ”„ Having issues? Try \"Retry Load\" for different proxy methods")
                            )
                        )
                    )
                )
            );
        }

        exports.default = MinecraftMemeGenerator;
    </script>
</head>
<body>
    <div id="preview-app"></div>


</body></html>